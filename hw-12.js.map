{"version":3,"file":"hw-12.js","sources":["../src/js/hw-12.js"],"sourcesContent":["const API_KEY =\n  '46463630-3c03a0f5bb3e2a02ee15ce5e1'; /* This should be kept a secret within Environmental Variables */\n\nconst lightbox = new SimpleLightbox(\n  '.gallery a#lightbox-link'\n); /* Fuck Lightbox and it's documentation BTW :) */\n\ndocument\n  .querySelector('form#image-search')\n  .addEventListener('submit', async event => {\n    event.preventDefault();\n\n    const form = event.target;\n\n    const searchQuery = form.elements['query'].value;\n\n    form.reset();\n\n    const gallery = document.querySelector('.gallery');\n\n    gallery.replaceChildren(createLoader());\n\n    /* `await` Could be changed to Promise callbacks, due to requirements */\n    const photosData = await getPhotos(searchQuery).catch(error => {\n      iziToast.error({\n        message: `Sorry, couldn't load images. Please try again later!`,\n        position: 'topRight',\n      });\n      console.error(error);\n      gallery.replaceChildren();\n    });\n\n    if (photosData.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      gallery.replaceChildren();\n      return;\n    }\n\n    const photoCards = photosData.hits\n      .map(toGalleryPhoto)\n      .map(createCard)\n      .map(applyLightbox);\n\n    gallery.replaceChildren(...photoCards);\n\n    lightbox.refresh();\n  });\n\nconst getPhotos = async searchQuery => {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  });\n\n  return fetch(`https://pixabay.com/api/?${params}`).then(response =>\n    response.json()\n  );\n};\n\nconst toGalleryPhoto = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n});\n\nconst createCard = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  const template = document.querySelector('template#card-template');\n  const card = document.importNode(template.content, true);\n\n  const lightboxLink = card.querySelector('a#lightbox-link');\n  lightboxLink.href = largeImageURL;\n\n  const img = card.querySelector('img.card-img');\n  img.src = webformatURL;\n  img.alt = tags;\n  img.title = tags;\n\n  card.querySelector(\n    `span.card-stats-item-count[data-item=\"likes\"]`\n  ).textContent = likes;\n\n  card.querySelector(\n    `span.card-stats-item-count[data-item=\"views\"]`\n  ).textContent = views;\n\n  card.querySelector(\n    `span.card-stats-item-count[data-item=\"comments\"]`\n  ).textContent = comments;\n\n  card.querySelector(\n    `span.card-stats-item-count[data-item=\"downloads\"]`\n  ).textContent = downloads;\n\n  return card;\n};\n\nconst applyLightbox = card => {\n  card.querySelector('a#lightbox-link').addEventListener('click', event => {\n    event.preventDefault();\n\n    const closeModalOnEscape = event => {\n      if (event.key === 'Escape') {\n        document.removeEventListener('keydown', closeModalOnEscape);\n        lightbox.close();\n      }\n    };\n\n    document.addEventListener('keydown', closeModalOnEscape);\n\n    lightbox.open(event.currentTarget);\n  });\n\n  return card;\n};\n\nconst createLoader = () =>\n  Object.assign(document.createElement('div'), { className: 'loader' });\n"],"names":["API_KEY","lightbox","event","form","searchQuery","gallery","createLoader","photosData","getPhotos","error","photoCards","toGalleryPhoto","createCard","applyLightbox","params","response","webformatURL","largeImageURL","tags","likes","views","comments","downloads","template","card","lightboxLink","img","closeModalOnEscape"],"mappings":"oCAAA,MAAMA,EACJ,qCAEIC,EAAW,IAAI,eACnB,0BACF,EAEA,SACG,cAAc,mBAAmB,EACjC,iBAAiB,SAAU,MAAMC,GAAS,CACzCA,EAAM,eAAc,EAEpB,MAAMC,EAAOD,EAAM,OAEbE,EAAcD,EAAK,SAAS,MAAS,MAE3CA,EAAK,MAAK,EAEV,MAAME,EAAU,SAAS,cAAc,UAAU,EAEjDA,EAAQ,gBAAgBC,EAAY,CAAE,EAGtC,MAAMC,EAAa,MAAMC,EAAUJ,CAAW,EAAE,MAAMK,GAAS,CAC7D,SAAS,MAAM,CACb,QAAS,uDACT,SAAU,UAClB,CAAO,EACD,QAAQ,MAAMA,CAAK,EACnBJ,EAAQ,gBAAe,CAC7B,CAAK,EAED,GAAIE,EAAW,KAAK,SAAW,EAAG,CAChC,SAAS,MAAM,CACb,QACE,2EACF,SAAU,UAClB,CAAO,EACDF,EAAQ,gBAAe,EACvB,MACD,CAED,MAAMK,EAAaH,EAAW,KAC3B,IAAII,CAAc,EAClB,IAAIC,CAAU,EACd,IAAIC,CAAa,EAEpBR,EAAQ,gBAAgB,GAAGK,CAAU,EAErCT,EAAS,QAAO,CACpB,CAAG,EAEH,MAAMO,EAAY,MAAMJ,GAAe,CACrC,MAAMU,EAAS,IAAI,gBAAgB,CACjC,IAAKd,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,EAChB,CAAG,EAED,OAAO,MAAM,4BAA4BU,CAAM,EAAE,EAAE,KAAKC,GACtDA,EAAS,KAAM,CACnB,CACA,EAEMJ,EAAiB,CAAC,CACtB,aAAAK,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,KAAO,CACL,aAAAN,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,GAEMV,EAAa,CAAC,CAClB,aAAAI,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,IAAM,CACJ,MAAMC,EAAW,SAAS,cAAc,wBAAwB,EAC1DC,EAAO,SAAS,WAAWD,EAAS,QAAS,EAAI,EAEjDE,EAAeD,EAAK,cAAc,iBAAiB,EACzDC,EAAa,KAAOR,EAEpB,MAAMS,EAAMF,EAAK,cAAc,cAAc,EAC7C,OAAAE,EAAI,IAAMV,EACVU,EAAI,IAAMR,EACVQ,EAAI,MAAQR,EAEZM,EAAK,cACH,+CACJ,EAAI,YAAcL,EAEhBK,EAAK,cACH,+CACJ,EAAI,YAAcJ,EAEhBI,EAAK,cACH,kDACJ,EAAI,YAAcH,EAEhBG,EAAK,cACH,mDACJ,EAAI,YAAcF,EAETE,CACT,EAEMX,EAAgBW,IACpBA,EAAK,cAAc,iBAAiB,EAAE,iBAAiB,QAAStB,GAAS,CACvEA,EAAM,eAAc,EAEpB,MAAMyB,EAAqBzB,GAAS,CAC9BA,EAAM,MAAQ,WAChB,SAAS,oBAAoB,UAAWyB,CAAkB,EAC1D1B,EAAS,MAAK,EAEtB,EAEI,SAAS,iBAAiB,UAAW0B,CAAkB,EAEvD1B,EAAS,KAAKC,EAAM,aAAa,CACrC,CAAG,EAEMsB,GAGHlB,EAAe,IACnB,OAAO,OAAO,SAAS,cAAc,KAAK,EAAG,CAAE,UAAW,SAAU"}