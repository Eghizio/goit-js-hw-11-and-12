var k=t=>{throw TypeError(t)};var x=(t,e,s)=>e.has(t)||k("Cannot "+s);var o=(t,e,s)=>(x(t,e,"read from private field"),s?s.call(t):e.get(t)),n=(t,e,s)=>e.has(t)?k("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),a=(t,e,s,r)=>(x(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s),E=(t,e,s)=>(x(t,e,"access private method"),s);var L=(t,e,s,r)=>({set _(i){a(t,e,i,s)},get _(){return o(t,e,r)}});import"./assets/styles-DD3qoKza.js";var c;class C{constructor(e){n(this,c);a(this,c,document.querySelector(e))}getElement(){return o(this,c)}show(){o(this,c).disabled=!1,o(this,c).classList.remove("hidden")}hide(){o(this,c).disabled=!0,o(this,c).classList.add("hidden")}}c=new WeakMap;var l,y,m;class B{constructor({searchQuery:e,page:s,photos:r}={searchQuery:void 0,page:void 0,photos:void 0}){n(this,l);n(this,y);n(this,m);a(this,l,e??null),a(this,y,s??1),a(this,m,r??[])}get searchQuery(){return o(this,l)}get page(){return o(this,y)}get photos(){return o(this,m)}reset(){a(this,l,null),a(this,y,1),a(this,m,[])}setSearchQuery(e){o(this,l)!==e?(this.reset(),a(this,l,e)):this.nextPage()}nextPage(){L(this,y)._++}addPhotos(e){o(this,m).push(...e)}}l=new WeakMap,y=new WeakMap,m=new WeakMap;const q={error(t){iziToast.error({message:t,position:"topRight"})},info(t){iziToast.info({message:t,position:"topRight"})}},M="46463630-3c03a0f5bb3e2a02ee15ce5e1",A={async getPhotos(t,e=1){const s=new URLSearchParams({key:M,q:t,image_type:"photo",orientation:"horizontal",safesearch:!0,page:e,per_page:40});return(await axios.get("https://pixabay.com/api/",{params:s})).data}};var h,f,b,d,S,w,Q,T;class D{constructor(e,s,r,i){n(this,w);n(this,h);n(this,f);n(this,b);n(this,d);n(this,S);a(this,h,new B),a(this,f,document.querySelector(e)),a(this,b,s),a(this,d,r),a(this,S,i)}clear(){o(this,f).replaceChildren()}async loadPhotos(e){o(this,h).setSearchQuery(e),o(this,S).hide(),o(this,d).show();const s=o(this,h).photos.length===0;try{const r=await A.getPhotos(o(this,h).searchQuery,o(this,h).page);if(r.hits.length===0){if(!s){q.info("We're sorry, but you've reached the end of search results.");return}q.error("Sorry, there are no images matching your search query. Please try again!"),this.clear(),o(this,d).hide();return}o(this,h).addPhotos(r.hits),o(this,d).hide(),E(this,w,Q).call(this),s||N(),o(this,h).photos.length<r.totalHits?o(this,S).show():q.info("We're sorry, but you've reached the end of search results.")}catch{q.error("Sorry, couldn't load images. Please try again later!"),o(this,d).hide()}finally{o(this,b).refresh()}}}h=new WeakMap,f=new WeakMap,b=new WeakMap,d=new WeakMap,S=new WeakMap,w=new WeakSet,Q=function(){const e=o(this,h).photos.map(E(this,w,T).bind(this));o(this,f).replaceChildren(...e)},T=function(e){return G(z(R(e)),o(this,b))};const R=({webformatURL:t,largeImageURL:e,tags:s,likes:r,views:i,comments:p,downloads:g})=>({webformatURL:t,largeImageURL:e,tags:s,likes:r,views:i,comments:p,downloads:g}),z=({webformatURL:t,largeImageURL:e,tags:s,likes:r,views:i,comments:p,downloads:g})=>{const P=document.querySelector("template#card-template"),u=document.importNode(P.content,!0),_=u.querySelector("a#lightbox-link");_.href=e;const v=u.querySelector("img.card-img");return v.src=t,v.alt=s,v.title=s,u.querySelector('span.card-stats-item-count[data-item="likes"]').textContent=r,u.querySelector('span.card-stats-item-count[data-item="views"]').textContent=i,u.querySelector('span.card-stats-item-count[data-item="comments"]').textContent=p,u.querySelector('span.card-stats-item-count[data-item="downloads"]').textContent=g,u},G=(t,e)=>(t.querySelector("a#lightbox-link").addEventListener("click",s=>{s.preventDefault();const r=i=>{i.key==="Escape"&&(document.removeEventListener("keydown",r),e.close())};document.addEventListener("keydown",r),e.open(s.currentTarget)}),t),N=()=>{const t=document.querySelector(".card").getBoundingClientRect().height;scrollBy(0,2*t,{behavior:"smooth"})},H=()=>{const t=new SimpleLightbox(".gallery a#lightbox-link"),e=new C("div.loader"),s=new C('button[type="button"].btn'),r=new D(".gallery",t,e,s);let i;document.querySelector("form#image-search").addEventListener("submit",async p=>{p.preventDefault();const g=p.target,P=g.elements.query.value;g.reset(),i=P,await r.loadPhotos(P)}),s.getElement().addEventListener("click",()=>r.loadPhotos(i))};H();
//# sourceMappingURL=hw-12.js.map
